version: '3.8'

services:
  payload:
    # IMPORTANT: Replace with your actual GitHub Registry image path
    image: ghcr.io/daniblagojevic/danicod.es:latest
    pull_policy: always
    ports:
      - '3000:3000'
    # Remove the volumes and working_dir used for local dev
    # Remove the 'command' line; your Dockerfile should handle the start command
    depends_on:
      - mongo
    # In Dokploy, it is better to use the "Environment Variables" tab 
    # instead of env_file, but you can keep this if the file exists on the server.
    env_file:
      - .env

  mongo:
    image: mongo:latest
    # Do not expose ports to the public in production unless necessary
    # ports:
    #   - '27017:27017'
    volumes:
      - mongo_data:/data/db

volumes:
  mongo_data: